<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Socket.IO chat</title>
    <link href="https://cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <style>

      #messages {
        list-style-type: none;

        padding: 0px;
      }

      #messages li:nth-child(odd) {
        background: #eee;
        margin-top: 10px;
      }

      .video {
          display: block;
          /*border-radius: 50%;*/
          width: 300px;
      }

      .local-video {
          z-index: 1;
          border: 3px solid grey;
      }
    </style>
  </head>
  <body>

    <div class="container well" style="margin-top:20px;">

        <div class="col-md-4">
          <p id="room-name"></p>
          <button class="btn btn-success" id="start-call">创建房间</button>
          <button class="btn btn-default" id="join-call">加入房间</button>
          <hr>
          <video class="video local-video" id="local-video" autoplay muted></video>
          <video class="video" id="remote-video" autoplay></video>

        </div>

        <div class="col-md-8">

          <form class="form" action="">
            <div class="form-group">


              <ul id="messages"></ul>

              <div class="col-md-10">
                <input class="form-control" id="m" autocomplete="off" />
              </div>


              <div class="col-md-2">
                <button class="btn btn-success">发送</button>
              </div>
            </div>

          </form>
        </div>
    </div><!-- ./container -->


    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="https://cdn.firebase.com/v0/firebase.js"></script>

    <script src="./firebasevideochat.js"></script>
    <script src="./joinvideochat.js"></script>

    <script>
      var socket = io();
      // var socket = io.connect('https://qmen.space:3001', { rejectUnauthorized: false});
      $('form').submit(function(){
        socket.emit('chat message', $('#m').val());
        $('#m').val('');
        return false;
      });

      socket.on('chat message', function(msg){
        $('#messages').append($('<li>').text(msg));
        if($('#messages').children().length > 10) {
          $("ul li:eq(0)").remove();
        }
      });
    </script>

  </body>
</html>
